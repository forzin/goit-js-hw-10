{"version":3,"file":"commonHelpers.js","sources":["../src/js/1-timer.js"],"sourcesContent":["import flatpickr from \"flatpickr\";\nimport \"flatpickr/dist/flatpickr.min.css\";\n\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nlet userSelectedDate;\nconst buttonStart = document.querySelector(`button[data-start]`);\nconst inputDate = document.querySelector(`input#datetime-picker`);\nconst dataDays = document.querySelector(`span[data-days]`);\nconst dataHours = document.querySelector(`span[data-hours]`);\nconst dataMinutes = document.querySelector(`span[data-minutes]`);\nconst dataSeconds = document.querySelector(`span[data-seconds]`);\nconst daysTime = document.querySelector(`.flatpickr-weekday`);\n\n\n\n\nconst options = {\n    enableTime: true,\n    time_24hr: true,\n    defaultDate: new Date(),\n    minuteIncrement: 1,\n    \n    onReady(selectedDates, dateStr, instance) {\n        setTimeout(() => {\n            const dayHeaders = instance.calendarContainer.querySelectorAll('.flatpickr-weekday');\n\n            dayHeaders.forEach((header) => {\n                let text = header.textContent.trim();\n                if (text.length > 2) {\n                    text = text.slice(0, 2);\n                }\n                header.textContent = text;\n            });\n        }, 0); \n    },\n\n    onClose(selectedDates) {\n      userSelectedDate = selectedDates[0];\n      if (userSelectedDate > new Date()) {\n        console.log(userSelectedDate);\n        buttonStart.disabled = false;\n       \n\n      } else {\n        iziToast.show({\n            message: 'Please choose a date in the future',\n            messageColor: '#fff',\n            messageSize: '16px',\n            messageLineHeight: '150%',\n\n            maxWidth: 302,\n            position: 'topRight',\n            backgroundColor: ' #ef4040',\n\n            iconUrl: `../img/icon-error.svg`,\n            \n            iconColor: '#fff',\n        });\n        buttonStart.disabled = true;\n      }\n\n      \n    },\n};\n\n\n\n\nflatpickr(`input#datetime-picker`, options);\nbuttonStart.disabled = true;\n\nclass Timer {\n    constructor({ onTick }) {\n        this.isActive = false;\n        this.onTick = onTick;\n        \n        this.intervalId = null;\n        this.targetTime = null;\n    }\n\n    start(targetDate) {\n        if (this.isActive) {\n            return;\n        }\n\n        this.targetTime = targetDate.getTime();\n        this.isActive = true;\n        \n        inputDate.disabled = true;\n\n        this.intervalId = setInterval(() => {\n            const currentTime = Date.now();\n            const deltaTime = this.targetTime - currentTime;\n            const time = this.convertMs(deltaTime);\n            this.onTick(time);\n\n            if (deltaTime <= 0) {\n                clearInterval(this.intervalId);\n                this.isActive = false;\n                this.onTick(this.convertMs(0));\n                if (this.onComplete) {\n                    this.onComplete();\n                }\n                buttonStart.disabled = true;\n                inputDate.disabled = false;\n                return;\n            }\n        }, 1000)\n    }\n\n    convertMs(ms) {\n    \n        const second = 1000;\n        const minute = second * 60;\n        const hour = minute * 60;\n        const day = hour * 24;\n      \n        \n        const days = String(Math.floor(ms / day)).padStart(2, `0`);\n        \n        const hours = String(Math.floor((ms % day) / hour)).padStart(2, `0`);\n        \n        const minutes = String(Math.floor(((ms % day) % hour) / minute)).padStart(2, `0`);\n        \n        const seconds = String(Math.floor((((ms % day) % hour) % minute) / second)).padStart(2, `0`);\n\n        \n      \n        return { days, hours, minutes, seconds };\n    }\n\n}\n\nfunction updateClock ({ days, hours, minutes, seconds }) {\n    dataDays.textContent = `${days}`;\n    dataHours.textContent = `${hours}`;\n    dataMinutes.textContent = `${minutes}`;\n    dataSeconds.textContent = `${seconds}`;\n}\n\n\nconst timer = new Timer({\n    onTick: updateClock, \n});\n\nbuttonStart.addEventListener('click', () => {\n    if (userSelectedDate) {\n        timer.start(userSelectedDate); \n        buttonStart.disabled = true;\n    }\n});\n\n\n\n\n\n  \n  \n"],"names":["userSelectedDate","buttonStart","inputDate","dataDays","dataHours","dataMinutes","dataSeconds","options","selectedDates","dateStr","instance","header","text","iziToast","flatpickr","Timer","onTick","targetDate","currentTime","deltaTime","time","ms","days","hours","minutes","seconds","updateClock","timer"],"mappings":"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"}